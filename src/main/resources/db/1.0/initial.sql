--liquibase formatted sql

--changeset Razumava_M:20210401-1
CREATE TABLE `DEVELOPER`
(
    `ID`             VARCHAR(36) PRIMARY KEY,
    `SURNAME`        VARCHAR(50),
    `NAME`           VARCHAR(50),
    `SPECIALIZATION` VARCHAR(50),
    `LEVEL`          VARCHAR(50),
    `CV_LINK`        VARCHAR(255),
    `WORKLOAD`       INT,
    `SALARY`         INT,
    `PROJECT_ID`     VARCHAR(36),
    `UNIT_ID`        VARCHAR(36)
);

--changeset Razumava_M:20210401-2
CREATE TABLE `MANAGER`
(
    `ID`       VARCHAR(36) PRIMARY KEY,
    `SURNAME`  VARCHAR(50),
    `NAME`     VARCHAR(50),
    `POST`     VARCHAR(100),
    `CV_LINK`  VARCHAR(255),
    `WORKLOAD` INT,
    `SALARY`   INT,
    `UNIT_ID`  VARCHAR(255)
);

--changeset Razumava_M:20210401-3
CREATE TABLE `PROJECT`
(
    `ID`              VARCHAR(36) PRIMARY KEY,
    `NAME`            VARCHAR(100),
    `DESCRIPTION`     VARCHAR(255),
    `TYPE`            VARCHAR(20),
    `STATUS`          VARCHAR(20),
    `MANAGER_ID`      VARCHAR(36),
    `FORECASTED_COST` BIGINT,
    `ALREADY_SPENT`   BIGINT,
    `ALREADY_PAID`    BIGINT,
    `STARTED`         DATE,
    `FINISHED`        DATE
);

--changeset Razumava_M:20210401-4
CREATE TABLE `COST_HISTORY`
(
    `ID`           VARCHAR(36) PRIMARY KEY,
    `AMOUNT`       BIGINT,
    `PAYMENT_DATE` TIMESTAMP,
    `PROJECT_ID`   VARCHAR(36)
);

--changeset Razumava_M:20210401-5
CREATE TABLE `PAYMENT_HISTORY`
(
    `ID`           VARCHAR(36) PRIMARY KEY,
    `AMOUNT`       BIGINT,
    `PAYMENT_DATE` TIMESTAMP,
    `PROJECT_ID`   VARCHAR(36)
);

--changeset Razumava_M:20210401-6
CREATE TABLE `UNIT`
(
    `ID`            VARCHAR(36) PRIMARY KEY,
    `NAME`          VARCHAR(100),
    `DESCRIPTION`   VARCHAR(255),
    `HEAD_ID`       VARCHAR(36),
    `DEPARTMENT_ID` VARCHAR(36)
);

--changeset Razumava_M:20210401-7
CREATE TABLE `DEPARTMENT`
(
    `ID`          VARCHAR(36) PRIMARY KEY,
    `NAME`        VARCHAR(100),
    `DESCRIPTION` VARCHAR(255),
    `HEAD_ID`     VARCHAR(36)
);

--changeset Razumava_M:20210401-8
ALTER TABLE `DEVELOPER`
    ADD FOREIGN KEY (`PROJECT_ID`) REFERENCES `PROJECT` (`ID`) ON DELETE SET NULL;

--changeset Razumava_M:20210401-9
ALTER TABLE `DEVELOPER`
    ADD FOREIGN KEY (`UNIT_ID`) REFERENCES `UNIT` (`ID`) ON DELETE SET NULL;

--changeset Razumava_M:20210401-10
ALTER TABLE `MANAGER`
    ADD FOREIGN KEY (`UNIT_ID`) REFERENCES `UNIT` (`ID`) ON DELETE SET NULL;

--changeset Razumava_M:20210401-11
ALTER TABLE `PROJECT`
    ADD FOREIGN KEY (`MANAGER_ID`) REFERENCES `MANAGER` (`ID`) ON DELETE SET NULL;

--changeset Razumava_M:20210401-12
ALTER TABLE `COST_HISTORY`
    ADD FOREIGN KEY (`PROJECT_ID`) REFERENCES `PROJECT` (`ID`) ON DELETE SET NULL;

--changeset Razumava_M:20210401-13
ALTER TABLE `PAYMENT_HISTORY`
    ADD FOREIGN KEY (`PROJECT_ID`) REFERENCES `PROJECT` (`ID`) ON DELETE SET NULL;

--changeset Razumava_M:20210401-14
ALTER TABLE `UNIT`
    ADD FOREIGN KEY (`HEAD_ID`) REFERENCES `MANAGER` (`ID`) ON DELETE SET NULL;

--changeset Razumava_M:20210401-15
ALTER TABLE `UNIT`
    ADD FOREIGN KEY (`DEPARTMENT_ID`) REFERENCES `DEPARTMENT` (`ID`) ON DELETE SET NULL;

--changeset Razumava_M:20210401-16
ALTER TABLE `DEPARTMENT`
    ADD FOREIGN KEY (`HEAD_ID`) REFERENCES `MANAGER` (`ID`) ON DELETE SET NULL;
